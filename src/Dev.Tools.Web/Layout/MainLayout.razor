@using System.Globalization
@inherits LayoutComponentBase

<MudThemeProvider @ref="_themeProvider" IsDarkMode="@IsDarkMode" ObserveSystemThemeChange="@ObserveSystemThemeChange" />
<MudPopoverProvider />
<MudDialogProvider />
<MudSnackbarProvider />

<MudLayout @key="CultureInfo.CurrentUICulture.Name">
    <MudAppBar Elevation="0" Dense="true"
               Style="background-color: var(--mud-palette-background)">
        <MudIconButton
            Icon="@Icons.Material.Outlined.Menu"
            Size="Size.Medium"
            Variant="Variant.Text"
            DropShadow="false"
            Edge="Edge.Start"
            OnClick="@DrawerToggle"/>

        @if (!IsDrawerOpen)
        {
            <MudLink Underline="Underline.None" Href="./">
                <MudText Typo="Typo.h6" Color="Color.Primary">@Context.AppDetails.Name.ToUpper()</MudText>
            </MudLink>
        }

        <MudSpacer />

        @if (!Context.Navigation.Uri.EndsWith("/"))
        {
            <MudIconButton Icon="@Icons.Material.Outlined.Search"
                           Color="Color.Inherit"
                           OnClick="@OpenSearchDialogAsync"/>
        }
        
        <MudIconButton Icon="@LightModeIcon" OnClick="@ChangeThemeModeAsync" />
        <MudIconButton Icon="@Icons.Material.Outlined.Settings" Edge="Edge.End" Href="settings" />
    </MudAppBar>

    <MudDrawer Elevation="2" Breakpoint="Breakpoint.Md" ClipMode="DrawerClipMode.Never" Open="@IsDrawerOpen" Style="display: flex; flex-direction: column;">
        <MudDrawerHeader LinkToIndex="true" Style="flex-shrink: 0;">
            <MudStack>
                <MudText Typo="Typo.h5" Align="Align.Center" Color="Color.Primary">DEV TOOLS</MudText>

                <MudText Typo="Typo.body2" Align="Align.Center" Color="Color.Default">@_localizer["Subtitle"]</MudText>
            </MudStack>
        </MudDrawerHeader>
        <MudDrawerContainer Class="mt-4" Style="flex-grow: 1; overflow-y: auto;">
            <NavMenu/>
            
            <MudStack Class="mt-10">
                <AppDetails/>
            </MudStack>
        </MudDrawerContainer>
    </MudDrawer>

    <MudMainContent>
        <MudContainer MaxWidth="MaxWidth.Large">
            @Body
        </MudContainer>
    </MudMainContent>
</MudLayout>
