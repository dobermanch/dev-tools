@using Dev.Tools.Providers
<MudNavMenu>
    @foreach (var group in _tools)
    {
        <MudNavGroup Title="@Context.Localization.GetCategory(group.Key)" Expanded="true">
            @foreach (var tool in group)
            {
                <MudNavLink
                    Icon="@GetToolIcon(tool.Item2)"
                    IconColor="Color.Primary"
                    Href="@($"/tools/{tool.Item2.Name}")"
                    Match="NavLinkMatch.Prefix">
                    @Context.Localization.GetToolTitle(tool.Item2)
                </MudNavLink>
            }
        </MudNavGroup>
    }
    <MudNavLink Href="/settings" Icon="@Icons.Material.Outlined.Settings" Match="NavLinkMatch.Prefix">Settings</MudNavLink>
</MudNavMenu>

@code{

    [Inject] private IToolsProvider ToolsProvider { get; set; } = null!;
    [Inject] private WebContext Context { get; set; } = null!;

    private GroupedList<Category, (Category, ToolDefinition)> _tools = GroupedList<Category, (Category, ToolDefinition)>.Empty;

    protected override void OnInitialized()
    {
        var tools = ToolsProvider.GetToolDefinitions();

        (Category category, ToolDefinition tools)[] grouped =
            tools
                .SelectMany(it => it.Categories.Select(x => (category: x, tools: it)))
                .ToArray();

        _tools = new GroupedList<Category, (Category, ToolDefinition)>(it => it.Item1, grouped);
        
        base.OnInitialized();
    }

    private string GetToolIcon(ToolDefinition tool)
    {
        return tool.Name switch
        {
            "base64-encoder" => Icons.Material.Outlined.DataObject,
            "base64-decoder" => Icons.Material.Outlined.DataArray,
            "case-converter" => Icons.Material.Outlined.TextFormat,
            "char-viewer" => Icons.Material.Outlined.Visibility,
            "date-convert" => Icons.Material.Outlined.Schedule,
            "hash" => Icons.Material.Outlined.Tag,
            "int-base-converter" => Icons.Material.Outlined.Calculate,
            "roman-converter" => Icons.Material.Outlined.FormatListNumbered,
            "ip-details" => Icons.Material.Outlined.Lan,
            "json-formatter" => Icons.Material.Outlined.Code,
            "passphrase-generator" => Icons.Material.Outlined.VpnKey,
            "rsa-generator" => Icons.Material.Outlined.Key,
            "url-transcoder" => Icons.Material.Outlined.Link,
            "nato" => Icons.Material.Outlined.RecordVoiceOver,
            "token-generator" => Icons.Material.Outlined.Token,
            "ulid-generator" => Icons.Material.Outlined.Fingerprint,
            "url-parser" => Icons.Material.Outlined.TravelExplore,
            "uuid-generator" => Icons.Material.Outlined.QrCode2,
            _ => Icons.Material.Outlined.Construction
        };
    }
}