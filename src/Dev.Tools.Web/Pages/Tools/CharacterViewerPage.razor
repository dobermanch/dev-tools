@page "/tools/char-viewer"

<DtToolPageHeader ToolDefinition="@_toolDefinition"/>

<MudCard Class="my-4">
    <MudCardContent>
        <DtSection Id="config" Class="mt-0">
            <MudGrid Class="align-center" Spacing="4">
                <MudItem xs="12" md="6">
                    <DtSelectEnum
                        T="CharacterViewerTool.ViewType"
                        Label="@_localizer["Select.ViewType.Label"]"
                        Value="@_args.ViewType"
                        ValueToDisplay="@(type => Context.Localization.GetToolEnum(_toolDefinition, type))"
                        ValueChanged="OnViewTypeChangedAsync"
                    />
                </MudItem>

                @if (HideSymbolsOptions)
                {
                    <MudItem xs="12" md="6">
                        <MudSwitch T="bool" @bind-Value="@_showSymbols" Label="@_localizer["Switch.ShowSymbols.Label"]"
                                   Color="Color.Primary"/>
                    </MudItem>
                }
            </MudGrid>
        </DtSection>

        <DtSection Id="io" ShowDivider="true">
            <MudGrid Class="align-center" Spacing="4">
                <MudItem xs="12" md="6">
                    <DtTextField
                        T="string"
                        Label="@_localizer["TextField.Input.Label"]"
                        Value="@_args.Text"
                        Error="@_result.HasErrors"
                        ErrorText="@_result.ErrorCodes.Select(it => Context.Localization.GetErrorCode(it)).FirstOrDefault("")"
                        LabelPosition="LabelPositionType.Inline"
                        Lines="15"
                        OnDebounceIntervalElapsed="OnTextValueChangedAsync"
                    />
                </MudItem>
                <MudItem xs="12" md="6">
                    <DtHtmlField
                        Label="@_localizer["TextField.Output.Label"]"
                        FormattedValue="@FormatText(_result.Text)"
                        Value="@_result.Text"
                        Lines="15"/>
                </MudItem>
            </MudGrid>
        </DtSection>

        @if (_result.CharInfos.Count > 0)
        {
            <DtSection Id="output" ShowDivider="true">
                <MudText Typo="Typo.h6">@_localizer["Section.CharacterInfo.Title"]</MudText>

                <MudTable Items="@_result.CharInfos" Elevation="0" Dense="true" Hover="true" Bordered="true"
                          Striped="false" Height="600" HorizontalScrollbar="true">
                    <HeaderContent>
                        <MudTh>@_localizer["Table.Header.Char"]</MudTh>
                        <MudTh>@_localizer["Table.Header.Category"]</MudTh>
                        <MudTh>@_localizer["Table.Header.Printable"]</MudTh>
                        <MudTh>@_localizer["Table.Header.Hex"]</MudTh>
                        <MudTh>@_localizer["Table.Header.Unicode"]</MudTh>
                        <MudTh>@_localizer["Table.Header.ASCII"]</MudTh>
                        <MudTh>@_localizer["Table.Header.HTML"]</MudTh>
                        <MudTh>@_localizer["Table.Header.URL"]</MudTh>
                    </HeaderContent>

                    <RowTemplate>
                        <MudTd>@context.Char</MudTd>
                        <MudTd>@context.UnicodeCategory</MudTd>
                        <MudTd>@CharToDisplay(context.Char)</MudTd>
                        <MudTd>@context.HexCode</MudTd>
                        <MudTd>@context.UnicodeDisplayString</MudTd>
                        <MudTd>@context.AsciiCode</MudTd>
                        <MudTd>@context.HtmlString</MudTd>
                        <MudTd>@context.UrlString</MudTd>
                    </RowTemplate>
                </MudTable>
            </DtSection>
        }
    </MudCardContent>
</MudCard>
